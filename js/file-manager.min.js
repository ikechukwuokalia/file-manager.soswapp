function populateDnav(){let e={},a=0;$.each(param,function(t,s){s.length>0&&(e[t]=s,++a)}),a>0&&$(document).find("#sos-dnav-wrap li a").each(function(a){if("#"!==$(this).attr("href")){let a=$(this).attr("href");$.each(e,function(e,t){url.parse(a,"pathname").indexOf(e)?"type"!==e&&(a=set_get(a,e,t)):a=set_get(a,e,t)}),$(this).attr("href",a)}})}"undefined"==typeof io&&(window.io={});const alterFile=(e=0,a="DELETE")=>{confirm(`Are you sure you want to ${a.toLowerCase()} this file?`)&&($("#file-mod-form input[name=fid]").val(e),$("#file-mod-form input[name=action]").val(a),$("#file-mod-form").submit())},rotateImage=(e=0,a=90)=>{confirm("Are you sure you want to rotate this image?")&&($("#file-mod-form input[name=fid]").val(e),$("#file-mod-form input[name=action]").val("ROTATE"),$("#file-mod-form input[name=degree]").val(a),$("#file-mod-form").submit())},fetchFiles=e=>{e&&"0.0"==e.status&&e.files.length>0?($("#file-list").removeClass("no-file"),$("#file-pages, .pages").text(e.pages),$("#file-records").text(e.records),$("#file-page").val(e.page),$(".page").text(e.page),$("#file-limit").val(e.limit),e.has_next_page&&$("#file-next-page").data("page",e.next_page),e.has_previous_page&&$("#file-previous-page").data("page",e.previous_page),$("#file-list").listFiles(e.files),removeAlert()):($("#file-pages, .pages").text(0),$(".page").text(0),$("#file-list").html("").addClass("no-file"))};$.fn.listFiles=function(e){return!1},$.fn.pageFile=function(){let e=parseInt($(this).data("page")),a=parseInt($("#file-page").val());e>0&&e!==a&&($("#file-page").val(e),$("#file-query-form").submit())};const pConf=sos.config.page;function checkPost(e={}){e&&"0.0"===e.status&&setTimeout(function(){removeAlert(),requery()},1800)}function listFiles(e){let a=$(pConf.datacontainer);if(a.length>0&&e.length>0){a.removeClass("no-result");let t="";$.each(e,function(e,a){t+='<div class="grid-6-phone grid-4-tablet grid-3-laptop push-left">',t+=`<div class="file-box thumb ${a.type_group}">`,t+=`<div class="thumb-icon-wrap"> <a href="#" onclick="sos.fbx.url('/app/ikechukwuokalia/file-manager.soswapp/service/file-viewer.php', {fid:${a.id}},{exitBtn:true});"><span class="thumb-icon"></span></a> </div>`,"image"===a.type_group&&(t+=`<a href="#" onclick="sos.fbx.url('/app/ikechukwuokalia/file-manager.soswapp/service/file-viewer.php', {fid:${a.id}},{exitBtn:true});"> <img src="${setGet(a.url,{tn:(new Date).getTime(),getsize:"320"})}" alt="${a.min_caption}"> </a>`),t+='<div class="thumb-caption">',t+='<button class="expand-tool sos-btn blue show-phone show-tablet" onclick="$(this).parent().toggleClass(\'xpand\');"> <i class="fas fa-expand-alt fa-lg"></i></button>',t+=`<h3 class="fw-lighter">${a.min_caption}</h3>`,t+='<p class="btn-stack">',""!==param.set_as&&param.set_as!==a.set_as&&(t+=`<button onclick="sos.fbx.url('/app/ikechukwuokalia/file-manager.soswapp/service/set-default.php',{set_as : '${param.set_as}', callback : '${param.set_cb}', fid : ${a.id}, set_ttl : '${param.set_ttl}'},{exitBtn : true});" title="Set as ${param.set_ttl}" class="file-action sos-btn green"> <i class="fas fa-check-circle"></i> <span class="btn-text">Set as</span></button>`),a.set_as&&(t+=`<button onclick="sos.fbx.url('/app/ikechukwuokalia/file-manager.soswapp/service/unset-default.php',{callback : 'requery', fid : ${a.id}},{exitBtn : true});" title="Unset default" class="file-action sos-btn grey"> <i class="far fa-circle"></i> <span class="btn-text">Unset</span></button>`),0==a.locked&&(t+=`<button onclick="sos.fbx.url('/app/ikechukwuokalia/file-manager.soswapp/service/set-caption.php',{fid:${a.id}, callback : 'requery'},{exitBtn: true});" class="file-action sos-btn blue"> <i class="fas fa-edit"></i> <span class="btn-text">Edit caption</span></button>`,"image"==a.type_group&&(t+=`<button onclick="goCrop(${a.id},{crp_cb:'requery'})" class="file-action sos-btn blue"> <i class="fas fa-crop"></i> <span class="btn-text">Crop image</span></button>`,0==a.watermarked&&a.can_watermark,t+=`<button onclick="rotateImage(${a.id},90);" class="file-action sos-btn yellow"> <i class="fas fa-undo"></i> <span class="btn-text">Rotate</span></button>`,t+=`<button onclick="rotateImage(${a.id},-90);" class="file-action sos-btn yellow"> <i class="fas fa-redo"></i> <span class="btn-text">Rotate</span></button>`),t+=`<button onclick="alterFile(${a.id}, 'LOCK');" class="file-action sos-btn black"> <i class="fas fa-lock"></i> <span class="btn-text">Lock file</span></button>`),a.set_as||(t+=`<button onclick="alterFile(${a.id}, 'DELETE');" class="file-action sos-btn red"> <i class="fas fa-trash"></i> <span class="btn-text">Delete</span></button>`),t+="</p>",t+="</div>",t+="</div>",t+="</div>"}),a.html(t)}}window.requery=function(){$("#query-form").length>0&&$("#query-form").submit()};const doFetch=e=>{if(e&&"0.0"==e.status&&object_length(e[pConf.datasearch])>0){if($(".pages-text").text(e.pages),$(".pages-val").val(e.pages),sos.config.page.pages=e.pages,$(".records-text").text(e.records),$(".records-val").val(e.records),sos.config.page.records=e.records,$(".page-val").val(e.page),$(".page-text").text(e.page),sos.config.page.page=e.page,$(".limit-val").val(e.limit),$(".limit-text").text(e.limit),sos.config.page.limit=e.limit,e.has_next_page&&$("#next-page").data("page",e.next_page),sos.config.page.hasNextPage=e.has_next_page,e.has_previous_page&&$("#previous-page").data("page",e.previous_page),sos.config.page.hasPreviousPage=e.has_previous_page,"function"==typeof window[pConf.datahandle]&&window[pConf.datahandle](e[pConf.datasearch]),removeAlert(),pageNatr(),history.pushState){let a=setGet(location.href,{page:e.page,limit:e.limit,search:e.search,type:e.type,id:e.id,ids:e.ids});window.history.pushState({path:a},"",a)}}else $(`${pConf.datacontainer}`).html("").addClass("no-result");pageNatr()},pageNatr=()=>{let e=$(`${pConf.datapager}`);pConf.hasPreviousPage?($(document).find("button.prev-page-btn").remove(),e.append($(`<button class='sos-btn face-secondary prev-page-btn' onclick="pageTo(${pConf.page-1});"> <i class="fas fa-2x fa-angle-left"></i></button>`))):$(document).find("button.prev-page-btn").remove(),pConf.hasNextPage?($(document).find("button.next-page-btn").remove(),e.append($(`<button class='sos-btn face-secondary next-page-btn' onclick="pageTo(${pConf.page+1});"> <i class="fas fa-2x fa-angle-right"></i></button>`))):$(document).find("button.next-page-btn").remove()},pageTo=(e=0)=>{e>0&&($(".page-val").val(e),requery())};function doPost(e={}){(e&&"0.0"==e.status||e.errors.length<1)&&("callback"in param&&"function"==typeof window[param.callback]?(faderBox.close(),window[param.callback](e)):setTimeout(function(){faderBox.close(),removeAlert(),requery()},1500))}